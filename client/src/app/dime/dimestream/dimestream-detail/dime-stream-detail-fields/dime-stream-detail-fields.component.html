<button *ngIf="!mainService.curItemAssignedFields && mainService.curItemEnvironmentType != 'PBCS'" type="button" class="btn btn-default btn-xs" (click)="mainService.listFieldsFromSourceEnvironment(mainService.curItem.id)">
	Refresh Fields from Server
</button>
<button *ngIf="!mainService.curItemAssignedFields && !mainService.curItemSourcedFields && mainService.curItemEnvironmentType == 'PBCS'" type="button" class="btn btn-default btn-xs" (click)="mainService.fieldsInitiateForPBCS()">Start</button>
<button *ngIf="!mainService.curItemAssignedFields && mainService.curItemSourcedFields && mainService.curItemEnvironmentType == 'PBCS'" type="button" class="btn btn-default btn-xs" (click)="mainService.fieldsAddtoPBCS()">Add New Field</button>
<button *ngIf="mainService.curItemSourcedFields" type="button" class="btn btn-default btn-xs" (click)="mainService.assignFields()">Assign Fields</button>
<button *ngIf="mainService.curItemAssignedFields" type="button" class="btn btn-default btn-xs" (click)="mainService.fieldsStartOver()">Start Over</button>
<button *ngIf="mainService.curItemAssignedFields" type="button" class="btn btn-default btn-xs" (click)="mainService.fieldsSave()">
	<i class="fa fa-save fa-fw"></i> Save Changes</button>
<hr *ngIf="mainService.curItemSourcedFields  || mainService.curItemAssignedFields">
<div *ngIf="mainService.curItemSourcedFields && !mainService.curItemAssignedFields && mainService.curItemEnvironmentType != 'PBCS'">
	<table class="table table-striped table-bordered table-hover table-condensed">
		<tr>
			<th>Name</th>
			<th>Type</th>
			<th *ngIf="mainService.curItemEnvironmentType != 'PBCS' && mainService.curItemEnvironmentType != 'HP'">Should Ignore?</th>
			<th *ngIf="mainService.curItemEnvironmentType != 'PBCS' && mainService.curItemEnvironmentType != 'HP'">Assign Properties</th>
			<th>Actions</th>
		</tr>
		<tr *ngFor="let curField of mainService.curItemSourcedFields;let i = index;let last=last;let first=first">
			<td>{{curField.name}}</td>
			<td>{{curField.type}}</td>
			<td *ngIf="mainService.curItemEnvironmentType != 'PBCS' && mainService.curItemEnvironmentType != 'HP'">
				<input type="checkbox" [(ngModel)]="curField.shouldIgnore">
			</td>
			<td *ngIf="mainService.curItemEnvironmentType != 'PBCS' && mainService.curItemEnvironmentType != 'HP'">
				<div class="input-group" *ngIf="curField.type=='number'">
					<span class="input-group-addon">
						<b># of Digits:</b>
					</span>
					<input type="number" class="form-control" placeholder="Whole Number Digits" [(ngModel)]="curField.precision" min="1" max="65">
					<span class="input-group-addon">(Min: 1, Max: 65)</span>
					<input type="number" class="form-control" placeholder="Decimal Number Digits" [(ngModel)]="curField.decimals" min="0" max="{{curField.precision -1 || 0}}">
					<span class="input-group-addon">(Min: 0, Max: {{curField.precision -1 || 0}})</span>
				</div>
				<div class="input-group" *ngIf="curField.type=='string'">
					<span class="input-group-addon">
						<b># of Chars:</b>
					</span>
					<input type="number" class="form-control" min="1" max="1024" [(ngModel)]="curField.characters">
					<span class="input-group-addon">(Max: 1024)</span>
				</div>
				<div class="input-group" *ngIf="curField.type=='date'">
					<span class="input-group-addon">
						<b>Format:</b>
					</span>
					<input type="text" class="form-control" [(ngModel)]="curField.dateFormat" placeholder="YYYY-MM-DD HH:mm">
					<span class="input-group-addon">(Y: Year, M: Month, D: Day, H: Hour, m: Minute)</span>
				</div>
			</td>
			<td>
				<div class="btn-group btn-group-xs" role="group">
					<button *ngIf="!last" type="button" class="btn btn-xs btn-default" title="Move Down" (click)="mainService.fieldMove(mainService.curItemSourcedFields, curField, 'down')">
						<i class="fa fa-caret-down fa-fw" aria-hidden="true"></i>
					</button>
					<button *ngIf="last || first" type="button" class="btn btn-xs btn-default" title="Nothing to do!">
						<i class="fa fa-fw" aria-hidden="true"></i>
					</button>
					<button *ngIf="!first" type="button" class="btn btn-xs btn-default" title="Move Up" (click)="mainService.fieldMove(mainService.curItemSourcedFields, curField, 'up')">
						<i class="fa fa-caret-up fa-fw" aria-hidden="true"></i>
					</button>
				</div>
			</td>

		</tr>
	</table>
</div>
<div *ngIf="mainService.curItemSourcedFields && !mainService.curItemAssignedFields && mainService.curItemEnvironmentType == 'PBCS'">
	<table class="table table-striped table-bordered table-hover table-condensed">
		<tr>
			<th>Name</th>
			<th>Type</th>
			<th *ngIf="mainService.curItemEnvironmentType != 'PBCS' && mainService.curItemEnvironmentType != 'HP'">Should Ignore?</th>
			<th *ngIf="mainService.curItemEnvironmentType != 'PBCS' && mainService.curItemEnvironmentType != 'HP'">Assign Properties</th>
			<th width="160px">Actions</th>
		</tr>
		<tr *ngFor="let curField of mainService.curItemSourcedFields;let i = index;let last=last;let first=first">
			<td>
				<input type="text" class="form-control" placeholder="Dimension Name" [(ngModel)]="curField.name">
			</td>
			<td>
				<select [(ngModel)]="curField.type" class="form-control">
					<option *ngFor="let curType of mainService.pbcsFieldTypes" value="{{curType}}">{{curType}}</option>
				</select>
			</td>
			<td>
				<div class="btn-group btn-group-xs" role="group">
					<button *ngIf="!last" type="button" class="btn btn-xs btn-default" title="Move Down" (click)="mainService.fieldMove(mainService.curItemSourcedFields, curField, 'down')">
						<i class="fa fa-caret-down fa-fw" aria-hidden="true"></i>
					</button>
					<button *ngIf="last || first" type="button" class="btn btn-xs btn-default" title="Nothing to do!">
						<i class="fa fa-fw" aria-hidden="true"></i>
					</button>
					<button *ngIf="!first" type="button" class="btn btn-xs btn-default" title="Move Up" (click)="mainService.fieldMove(mainService.curItemSourcedFields, curField, 'up')">
						<i class="fa fa-caret-up fa-fw" aria-hidden="true"></i>
					</button>
				</div>
				<div class="btn-group btn-group-xs pull-right" role="group">
					<button class="btn btn-danger" type="button" (click)="mainService.fieldsRemoveFromPBCS(i)">
						<i class="fa fa-trash fa-fw"></i>
					</button>
				</div>
			</td>

		</tr>
	</table>
</div>
<div *ngIf="mainService.curItemAssignedFields">
	<table class="table table-striped table-bordered table-hover table-condensed">
		<tr>
			<th>Name</th>
			<th>Type</th>
			<th *ngIf="mainService.curItemEnvironmentType != 'PBCS' && mainService.curItemEnvironmentType != 'HP'">Should Ignore?</th>
			<th *ngIf="mainService.curItemEnvironmentType != 'PBCS' && mainService.curItemEnvironmentType != 'HP'">Is Described?</th>
			<th *ngIf="mainService.curItemEnvironmentType != 'PBCS' && mainService.curItemEnvironmentType != 'HP'">Is Filter?</th>
			<th *ngIf="mainService.curItemEnvironmentType != 'PBCS' && mainService.curItemEnvironmentType != 'HP'">Is Month?</th>
			<th *ngIf="mainService.curItemEnvironmentType != 'PBCS' && mainService.curItemEnvironmentType != 'HP'">Is Data?</th>
			<th *ngIf="mainService.curItemEnvironmentType != 'PBCS' && mainService.curItemEnvironmentType != 'HP'">Is CrossTab?</th>
			<th>Should Ignore for Crosstab?</th>
			<th *ngIf="mainService.curItemEnvironmentType != 'PBCS' && mainService.curItemEnvironmentType != 'HP'">is Filter for Crosstab?</th>
			<th *ngIf="mainService.curItemEnvironmentType != 'PBCS' && mainService.curItemEnvironmentType != 'HP'">Aggregate Function</th>
			<th *ngIf="mainService.curItemEnvironmentType != 'PBCS' && mainService.curItemEnvironmentType != 'HP'">Assign Properties</th>
			<th *ngIf="mainService.curItemEnvironmentType == 'PBCS'">Generation 2 Member List (Children of #root member)</th>
			<th>Actions</th>
		</tr>
		<tr *ngFor="let curField of mainService.curItemAssignedFields;let i = index;let last=last;let first=first">
			<td>
				{{curField.name}}
				<br>
			</td>
			<td>{{curField.type}}</td>
			<td *ngIf="mainService.curItemEnvironmentType != 'PBCS' && mainService.curItemEnvironmentType != 'HP'">
				<input type="checkbox" [(ngModel)]="curField.shouldIgnore">
			</td>
			<td *ngIf="mainService.curItemEnvironmentType != 'PBCS' && mainService.curItemEnvironmentType != 'HP'">
				<input type="checkbox" [(ngModel)]="curField.isDescribed" ngTrueValue="1" ng-false-value="0">
			</td>
			<td *ngIf="mainService.curItemEnvironmentType != 'PBCS' && mainService.curItemEnvironmentType != 'HP'">
				<input type="checkbox" [(ngModel)]="curField.isFilter" ng-true-value="1" ng-false-value="0">
			</td>
			<td *ngIf="mainService.curItemEnvironmentType != 'PBCS' && mainService.curItemEnvironmentType != 'HP'">
				<input type="checkbox" [(ngModel)]="curField.isMonth" ng-true-value="1" ng-false-value="0">
			</td>
			<td *ngIf="mainService.curItemEnvironmentType != 'PBCS' && mainService.curItemEnvironmentType != 'HP'">
				<input type="checkbox" [(ngModel)]="curField.isData" ng-true-value="1" ng-false-value="0">
			</td>
			<td *ngIf="mainService.curItemEnvironmentType != 'PBCS' && mainService.curItemEnvironmentType != 'HP'">
				<input type="checkbox" [(ngModel)]="curField.isCrossTab" ng-true-value="1" ng-false-value="0">
			</td>
			<td>
				<input type="checkbox" [(ngModel)]="curField.shouldIgnoreCrossTab" ng-true-value="1" ng-false-value="0">
			</td>
			<td *ngIf="mainService.curItemEnvironmentType != 'PBCS' && mainService.curItemEnvironmentType != 'HP'">
				<input type="checkbox" [(ngModel)]="curField.isCrossTabFilter" ng-true-value="1" ng-false-value="0">
			</td>
			<td *ngIf="mainService.curItemEnvironmentType != 'PBCS' && mainService.curItemEnvironmentType != 'HP'">
				<select *ngIf="curField.isData == 1" [(ngModel)]="curField.aggregateFunction">
					<option value="">NONE</option>
					<option value="SUM">SUM</option>
					<option value="AVG">AVG</option>
					<option value="COUNT">COUNT</option>
					<option value="MAX">MAX</option>
					<option value="MIN">MIN</option>
				</select>
			</td>
			<td *ngIf="mainService.curItemEnvironmentType != 'PBCS' && mainService.curItemEnvironmentType != 'HP'">
				<div class="input-group" *ngIf="curField.type=='number'">
					<span class="input-group-addon">
						<b># of Digits:</b>
					</span>
					<input type="number" class="form-control" placeholder="Whole Number Digits" [(ngModel)]="curField.fPrecision" min="1" max="65">
					<span class="input-group-addon">(Min: 1, Max: 65)</span>
					<input type="number" class="form-control" placeholder="Decimal Number Digits" [(ngModel)]="curField.fDecimals" min="0" max="{{curField.fPrecision -1 || 0}}">
					<span class="input-group-addon">(Min: 0, Max: {{curField.fPrecision -1 || 0}})</span>
				</div>
				<div class="input-group" *ngIf="curField.type=='string'">
					<span class="input-group-addon">
						<b># of Chars:</b>
					</span>
					<input type="number" class="form-control" min="1" max="1024" [(ngModel)]="curField.fCharacters">
					<span class="input-group-addon">(Max: 1024)</span>
				</div>
				<div class="input-group" *ngIf="curField.type=='date'">
					<span class="input-group-addon">
						<b>Format:</b>
					</span>
					<input type="text" class="form-control" [(ngModel)]="curField.fDateFormat" placeholder="YYYY-MM-DD HH:mm">
					<span class="input-group-addon">(Y: Year, M: Month, D: Day, H: Hour, m: Minute)</span>
				</div>
			</td>
			<th *ngIf="mainService.curItemEnvironmentType == 'PBCS'">
				<input type="text" class="form-control" [(ngModel)]="curField.generation2members" placeholder="Separator is ||| and don't use any quotes for multi word member names">
			</th>
			<td>
				<div class="btn-group btn-group-xs" role="group">
					<button *ngIf="!last" type="button" class="btn btn-xs btn-default" title="Move Down" (click)="mainService.fieldMove(mainService.curItemAssignedFields, curField, 'down')">
						<i class="fa fa-caret-down fa-fw" aria-hidden="true"></i>
					</button>
					<button *ngIf="last || first" type="button" class="btn btn-xs btn-default" title="Nothing to do!">
						<i class="fa fa-fw" aria-hidden="true"></i>
					</button>
					<button *ngIf="!first" type="button" class="btn btn-xs btn-default" title="Move Up" (click)="mainService.fieldMove(mainService.curItemAssignedFields, curField, 'up')">
						<i class="fa fa-caret-up fa-fw" aria-hidden="true"></i>
					</button>
				</div>
			</td>

		</tr>
	</table>
</div>
